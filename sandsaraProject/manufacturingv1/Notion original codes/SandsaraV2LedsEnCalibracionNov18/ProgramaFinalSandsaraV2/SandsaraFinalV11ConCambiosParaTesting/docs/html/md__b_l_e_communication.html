<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Sandsara: BLE Communication</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo 50x50.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Sandsara
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md__b_l_e_communication.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">BLE Communication </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>If you are interest in creating you own app to communicate to Sandara you can find all you need to do it in our documentation. Here we explain how to read the doc.</p>
<h2>BLE Basics</h2>
<p>We use <a class="el" href="class_bluetooth.html" title="Se encarga de gestionar la comunicacion por bluetooth.">Bluetooth</a> Low Energy (BLE) to communicate to sandsara and change some of its properties. First of all we recomment to read some basics about BLE, here you can see some links you can read</p><ul>
<li><a href="https://www.bluetooth.com/learn-about-bluetooth/tech-overview/">https://www.bluetooth.com/learn-about-bluetooth/tech-overview/</a></li>
<li><a href="https://randomnerdtutorials.com/esp32-bluetooth-low-energy-ble-arduino-ide/">https://randomnerdtutorials.com/esp32-bluetooth-low-energy-ble-arduino-ide/</a></li>
</ul>
<p>We use the esp32 as a BLE server and you can connet to it as a client.</p>
<h2>Services and Characteristics</h2>
<p>We structure the comunication using 4 services and several characteristics. the services are list below: </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone">name  </th><th class="markdownTableHeadNone">description  </th><th class="markdownTableHeadNone">UUID   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1  </td><td class="markdownTableBodyNone">General Service  </td><td class="markdownTableBodyNone">it is used to change general properties  </td><td class="markdownTableBodyNone">fd31a840-22e7-11eb-adc1-0242ac120002   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2  </td><td class="markdownTableBodyNone">File Service  </td><td class="markdownTableBodyNone">It is used to receive or send files  </td><td class="markdownTableBodyNone">fd31abc4-22e7-11eb-adc1-0242ac120002   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">3  </td><td class="markdownTableBodyNone">Playlist Service  </td><td class="markdownTableBodyNone">it is used to control the playback of the paths  </td><td class="markdownTableBodyNone">fd31a778-22e7-11eb-adc1-0242ac120002   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">4  </td><td class="markdownTableBodyNone">LedStrip Service  </td><td class="markdownTableBodyNone">It is used to control de led strip  </td><td class="markdownTableBodyNone">fd31a2be-22e7-11eb-adc1-0242ac120002   </td></tr>
</table>
<p>As you know every service or characteristic can be indentified by its UUID so you can see above. In every service you will find its characteristics related to the description. </p><h2>BLE commands</h2>
<p>In the documentation we use the words characteristics and commands interchangeable and we describe every characteristic by its class. In order to make things clear let us explain how a characteristic is created in ESP32.</p><ol type="1">
<li>we create the BLECharacteristic object.</li>
<li>we use this object to handle the characteristic</li>
<li>we create a class that inheritates the BLECharacteristicCallbacks class.</li>
<li>we assosiate the BLECharacteristic object to a BLECharacteristicCallbacks object so we can handle every time the characteristic is written or read.</li>
</ol>
<p>For explanatory purposes we treat each BLECharacteristicCallbacks class as a characteristic (BLE command) so you will find all the characteristics in the <a href="annotated.html">Class list</a> page. Every class has a descriptive name so you can infer what is the purpose of each characteristic.</p>
<p>For example, lets take the <a class="el" href="classgeneral_callbacks__speed.html" title="[BLE Command] This class is used to create and object to be called when you write to the generalSpeed...">generalCallbacks_speed</a> class, you can infer that this characteristic is used to modify the speed of sandsara, in any way when you open the class you will see a description and how to use it. There are some things that are in each command, you can see a description of each section in a command page.</p>
<h3>Description</h3>
<p>At the top you will find a description of the characteristic.</p>
<h3>properties</h3>
<p>You will find a seccion called properties where you can fine the properties of each characteristic, the posible properties are listed below:</p><ul>
<li><b>read</b> means you can read the characteristic.</li>
<li><b>write</b> means you can write to the characteristic.</li>
<li><b>notify</b> you will be able to receive notifications from the characteristic.</li>
</ul>
<h3>usage</h3>
<p>In this section you can see how to use the characteristic</p>
<h3>Range</h3>
<p>Here you find what are the values the characteristic accepts</p>
<h3>BLE Error Messeages</h3>
<p>In order to give you a feeback about your interaction with the devices, every service has a characteristic that notify you the response of your interaction with the characteristics, for example, if you set a new speed you may need a confirmation if the speed was set or not. That is the reason why we create a the a errorMsg characteristic in each service. We recomment to follow the next steps before you communicate with BLE.</p><ol type="1">
<li>Indentify the service of the characteristic you will interact.</li>
<li>activate the errorMsg characteristic of that service.</li>
<li>interact with the desired characteristic.</li>
<li>wait to be notify by the errorMsg characteristic and read it for the response.</li>
</ol>
<p>Here you can see the UUID of each erroMsg Service characteristic. </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"></th><th class="markdownTableHeadNone">Service  </th><th class="markdownTableHeadNone">errorMsg characteristic  </th><th class="markdownTableHeadNone">UUID   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1  </td><td class="markdownTableBodyNone">General Service  </td><td class="markdownTableBodyNone">generalErrorMsg  </td><td class="markdownTableBodyNone">7b204d4a-30c3-11eb-adc1-0242ac120002   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2  </td><td class="markdownTableBodyNone">File Service  </td><td class="markdownTableBodyNone">fileErrorMsg  </td><td class="markdownTableBodyNone">fcbffce2-2af1-11eb-adc1-0242ac120002   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">3  </td><td class="markdownTableBodyNone">Playlist Service  </td><td class="markdownTableBodyNone">playlistErrorMsg  </td><td class="markdownTableBodyNone">9b12aa02-2c6e-11eb-adc1-0242ac120002   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">4  </td><td class="markdownTableBodyNone">LedStrip Service  </td><td class="markdownTableBodyNone">ledErrorMsg  </td><td class="markdownTableBodyNone">1a9a8880-2305-11eb-adc1-0242ac120002   </td></tr>
</table>
<dl class="section see"><dt>See also</dt><dd><a href="annotated.html">Class list</a> </dd></dl>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.15 </li>
  </ul>
</div>
</body>
</html>
